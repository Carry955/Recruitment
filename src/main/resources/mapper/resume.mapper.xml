<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.carry.recruitment.mapper.ResumeMapper">

<!--  插入数据  -->
    <insert id="insert">
        insert into t_resume(stu_id, cretime, avator, `name`, appraisal, birthday, gender, marry, political, province, city, tel, email, web, address) values (
            #{stu_id}, #{cretime}, #{avator}, #{name}, #{appraisal}, #{birthday}, #{gender}, #{marry}, #{political}, #{province}, #{city}, #{tel}, #{email}, #{web}, #{address}
        );
    </insert>
    <insert id="insertEdu">
        insert into t_edu(stu_id, university, `degree`, major, englevel, course, descp) values
            (#{stu_id}, #{university}, #{degree}, #{major}, #{englevel}, #{course}, #{descp})
    </insert>
    <insert id="insertWork">
        insert into t_work(stu_id, company, `position`, wcity, starttime, endtime, info) values
            (#{stu_id}, #{company}, #{position}, #{wcity}, #{startTime}, #{endTime}, #{info})
    </insert>
    <insert id="insertSkill">
        insert into t_skill(stu_id, skill, level) values
            (#{stu_id}, #{skill}, #{level})
    </insert>

    <update id="update">
        update t_resume
            set avator = #{avator}, `name` = #{name}, appraisal = #{appraisal}, birthday = #{birthday}, gender=#{gender}, marry = #{marry}, political = #{political}, province = #{province}, city = #{city}, tel = #{tel}, email = #{email}, web = #{web}, address = #{address}
            where id = #{id};
    </update>
    <update id="updateEdu">
        update t_edu
            set university = #{university}, degree = #{degree}, major = #{major}, englevel = #{englevel}, course=#{course}, descp=#{descp}
            where id = #{id};
    </update>
    <update id="updateWork">
        update t_work
            set company = #{company}, position = #{position}, wcity = #{wcity}, starttime = #{startTime}, endtime = #{endTime}, info = #{info}
            where id = #{id};
    </update>
    <update id="updateSkill">
        update t_skill
            set skill = #{skill}, level = #{level}
            where id = #{id};
    </update>

<!--  获取数据  -->
    <select id="getResumes" resultMap="ResumeMap">
        select * from t_resume where stu_id = #{stu_id};
    </select>
    <resultMap id="ResumeMap" type="Resume">
        <collection property="edus" javaType="java.util.ArrayList" ofType="EduExp" select="com.carry.recruitment.mapper.ResumeMapper.getEdus" column="stu_id = stu_id">
        </collection>
        <collection property="works" javaType="java.util.ArrayList" ofType="WorkExp" select="com.carry.recruitment.mapper.ResumeMapper.getWorks" column="stu_id = stu_id">
        </collection>
        <collection property="skills" javaType="java.util.ArrayList" ofType="Skill" select="com.carry.recruitment.mapper.ResumeMapper.getSkills" column="stu_id = stu_id">
        </collection>
    </resultMap>
    <select id="getEdus" resultType="EduExp">
        select * from t_edu where stu_id = #{stu_id};
    </select>
    <select id="getWorks" resultType="WorkExp">
        select * from t_work where stu_id = #{stu_id};
    </select>
    <select id="getSkills" resultType="Skill">
        select * from t_skill where stu_id = #{stu_id};
    </select>

    <select id="getResume" resultMap="ResumeMap">
        select * from t_resume where id = #{resume_id};
    </select>

</mapper>
